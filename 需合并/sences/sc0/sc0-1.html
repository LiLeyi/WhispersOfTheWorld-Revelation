<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>世界的低语：启示录</title>
    <!--游戏网站小图标-->
    <link href="#" type="image/x-icon" rel="icon">
    <!--css样式表-->
    <link rel="stylesheet" href="../../css/usualpage.css" />
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <!-- 放音乐 人物 台词的地方-->
    <script src="sc0-1.js"></script>
    <!--统一控制函数-->
    <script src="../../js/controll.js"></script>
    <!--背景音乐-->
    <script>
        window.localStorage.nowbgm = "#";
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // 安全获取 localStorage 中的用户数据
            var userArr = localStorage.getItem("userArr");
            var userId = localStorage.getItem("userid");

            if (!userArr || userId === null) return; // 如果没数据，直接退出
            var array = JSON.parse(userArr);

            if (!array[userId] || !array[userId].MSYflag) return;
            var flag = array[userId].MSYflag;

            // 获取元素
            var option2 = document.getElementById('option2');
            if (!option2) return;

            // 根据 flag[3] 修改样式（不隐藏，只加深显示）
            if (flag[3] == 1) {
                option2.style.opacity = '1';         // 完全显示
                option2.style.fontWeight = 'bold';   // 字体加粗
                option2.style.color = '#000';        // 深色文字
            } else {
                option2.style.opacity = '0.5';       // 半透明
                option2.style.fontWeight = 'normal'; // 正常字体
                option2.style.color = '#999';        // 灰色文字
            }
        });
    </script>


    <style>
        .background-slider {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            opacity: 1;
        }

        .background-image {
            background-image: url("../../images/background/sc3.1/page1.0.JPG");
            /* 第一张背景图片的路径 */
            position: absolute;
            /* 使用绝对定位，相对于父容器 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            /* 保持图片完整显示，可能会有留白 */
            background-repeat: no-repeat;
            background-position: center;
            /* 图片居中对齐 */
            background-color: black;
            /* 设置未被填充区域的背景颜色为黑色 */
        }

        #selection_box {
            display: none;
        }
    </style>
    <!--可以在这放音效之类的-->
    <audio id="music" src="#"></audio>

</head>
<!--创造两个图片渐变的动画-->

<body>
    <script>

        document.addEventListener("DOMContentLoaded", function () {
            // 保存当前页面路径供存档用
            localStorage.setItem("currentPage", window.location.pathname);
        });
    </script>

    <div class="background-slider">
        <div class="background-image" id="1"></div>
        <div class="background-image" id="2"></div>
    </div>
    <!--一些基本交互-->
    <div id="move" onclick="{ MusicPlayer(); next_move();}"></div>
    <div id="dialog" onclick="{ MusicPlayer(); next_move();}"></div>
    <div id="text-box" onclick="{ MusicPlayer(); next_move();}">
        <p id="name"></p>
        <p id="texts"></p>
    </div>
    <!--角色小图标-->
    <div id="small">
        <img src="../../img/none.png" id="small_pic">
    </div>
    <!--左边的立绘-->
    <div class="left">
        <img id="left" src="../../img/none.png">
    </div>
    <!--中间的立绘-->
    <div class="middle">
        <img id="middle" src="../../img/none.png">
    </div>
    <!--右边的立绘-->
    <div class="right">
        <img id="right" src="../../img/none.png">
    </div>
    <!--选项，里面放跳转地址，选项数量可以自行扩展-->
    <div id="selection_box">
        <p><input type="button" value="选项B" class="selection" id="option2" onclick="{ MusicPlayer2(); goto('#'); }"></p>
        <p><input type="button" value="选项A" class="selection" id="option1" onclick="{ MusicPlayer2(); goto('#'); }"></p>
    </div>

    <!--菜单-->
    <div id="menu">
        <button class=op id="op_return"
            onClick="document.getElementById('return').classList.toggle('active');"><strong>return</strong></button>&nbsp;&nbsp;&nbsp;
        <button class=op id="op_load"
            onClick="redirectToNewPage('../../load.html')"><strong>load</strong></button>&nbsp;&nbsp;&nbsp;
        <button class="op" id="op_auto" onClick="startAutoClick();"><strong>auto</strong></button>&nbsp;&nbsp;&nbsp;
        <button class=op id="op_skip"
            onClick="document.getElementById('skip').classList.toggle('active');"><strong>skip</strong></button>&nbsp;&nbsp;&nbsp;
    </div>
    <!--跳过弹窗-->
    <div class="menuwindow" id="skip">
        <h1 class="menutitle" id="config_h1">是否跳过这一章节</h1>
        <div class="menuitemleft">
            <button type="submit" class="btn" id="btn1" onClick="goto('../' + pagename);">YES</button>
        </div>
        <div class="menuitemright">
            <button type="submit" class="btn" id="btn2"
                onClick="document.getElementById('skip').classList.toggle('active');">NO</button>
        </div>
    </div>
    <!--返回弹窗-->
    <div class="menuwindow" id="return">
        <h1 class="menutitle" id="config_h1">是否返回标题</h1>
        <div class="menuitemleft">
            <button type="submit" class="btn" id="btn1" onClick="Return()">YES</button>
        </div>
        <div class="menuitemright">
            <button type="submit" class="btn" id="btn2"
                onClick="document.getElementById('return').classList.toggle('active');">NO</button>
        </div>
    </div>
    <!--保存进度  -->
    <script>
        window.localStorage.MSYgamename = op.gamename;
        window.localStorage.MSYbackgroundIMG = op.background[click];
        window.onload = function () {
            // 读取 URL 中的 click 参数，如果没有就用 localStorage
            const urlParams = new URLSearchParams(window.location.search);
            click = parseInt(urlParams.get('click')) || parseInt(localStorage.getItem("nowclick")) || 0;

            // 恢复文字、背景、音乐
            next_text();
            changeBackground();
            bgmchange();
        }

    </script>

</body>

</html>